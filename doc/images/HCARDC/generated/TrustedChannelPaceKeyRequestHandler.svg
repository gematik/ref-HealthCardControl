<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1081px" preserveAspectRatio="none" style="width:1244px;height:1081px;" version="1.1" viewBox="0 0 1244 1081" width="1244px" zoomAndPan="magnify"><defs><filter height="300%" id="f1qjbjj5ydlljr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster de.gematik.ti.healthcard.control--><polygon fill="#FFFFFF" filter="url(#f1qjbjj5ydlljr)" points="289.5,24,518.5,24,525.5,47.6094,854.5,47.6094,854.5,975,289.5,975,289.5,24" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="289.5" x2="525.5" y1="47.6094" y2="47.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="223" x="293.5" y="40.5332">de.gematik.ti.healthcard.control</text><!--cluster de.gematik.ti.healthcard.control.security--><polygon fill="#FFFFFF" filter="url(#f1qjbjj5ydlljr)" points="313.5,310,602.5,310,609.5,333.6094,830.5,333.6094,830.5,951,313.5,951,313.5,310" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="313.5" x2="609.5" y1="333.6094" y2="333.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="283" x="317.5" y="326.5332">de.gematik.ti.healthcard.control.security</text><!--cluster java.lang--><polygon fill="#FFFFFF" filter="url(#f1qjbjj5ydlljr)" points="878.5,86,947.5,86,954.5,109.6094,982.5,109.6094,982.5,200,878.5,200,878.5,86" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="878.5" x2="954.5" y1="109.6094" y2="109.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="63" x="882.5" y="102.5332">java.lang</text><!--class TrustedChannelPaceKeyRequestHandler--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="186.3594" id="TrustedChannelPaceKeyRequestHandler" style="stroke: #A80036; stroke-width: 1.5;" width="272" x="388.5" y="60"/><ellipse cx="408.9" cy="76" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M410.9,72.5 Q411.1031,72 411.3375,71.75 Q411.5719,71.5 411.8375,71.5 Q412.3063,71.5 412.6031,71.7813 Q412.9,72.0625 412.9,72.7188 L412.9,74.2813 Q412.9,74.9375 412.6188,75.2188 Q412.3375,75.5 411.9,75.5 Q411.5094,75.5 411.2594,75.3281 Q411.0094,75.1563 410.9,74.7031 Q410.8531,74.3906 410.6813,74.2188 Q410.3688,73.8906 409.8063,73.7031 Q409.2438,73.5 408.6813,73.5 Q407.9781,73.5 407.3844,73.7813 Q406.8063,74.0625 406.3531,74.6875 Q405.9,75.3125 405.9,76.1719 L405.9,77.0938 Q405.9,78.125 406.7438,78.8125 Q407.5875,79.5 409.0875,79.5 Q409.9781,79.5 410.6031,79.2969 Q410.9625,79.1875 411.3688,78.8281 Q411.6344,78.625 411.775,78.5625 Q411.9156,78.5 412.0875,78.5 Q412.4156,78.5 412.65,78.7656 Q412.9,79.0156 412.9,79.375 Q412.9,79.7188 412.5563,80.125 Q412.0563,80.7188 411.2594,81.0469 Q410.2125,81.5 408.9313,81.5 Q407.4313,81.5 406.2281,80.9063 Q405.2594,80.4375 404.5719,79.4219 Q403.9,78.4063 403.9,77.2031 L403.9,76.1094 Q403.9,74.8594 404.4938,73.7656 Q405.1031,72.6719 406.15,72.0938 Q407.2125,71.5 408.4,71.5 Q409.1188,71.5 409.7438,71.75 Q410.3688,72 410.9,72.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="228" x="424.1" y="80.9102">TrustedChannelPaceKeyRequestHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="389.5" x2="659.5" y1="92" y2="92"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="101.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="408.5" y="107.4189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="115.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="59" x="408.5" y="121.2549">TAG : String</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="129.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="246" x="408.5" y="135.0908">instance : TrustedChannelPaceKeyRequestHandler</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="389.5" x2="659.5" y1="141.5078" y2="141.5078"/><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="150.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="204" x="408.5" y="156.9268">TrustedChannelPaceKeyRequestHandler()</text><ellipse cx="399.5" cy="167.7617" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="64" x="408.5" y="170.7627">getInstance()</text><ellipse cx="399.5" cy="181.5977" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="71" x="408.5" y="184.5986">startHandling()</text><ellipse cx="399.5" cy="195.4336" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="70" x="408.5" y="198.4346">stopHandling()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="206.2695"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="45" x="408.5" y="212.2705">register()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="396.5" y="220.1055"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="57" x="408.5" y="226.1064">unregister()</text><ellipse cx="399.5" cy="236.9414" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="150" x="408.5" y="239.9424">handleRequestPaceKeyEvent()</text><!--class CardAccessNumberRequester--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="103.3438" id="CardAccessNumberRequester" style="stroke: #A80036; stroke-width: 1.5;" width="275" x="539" y="769.5"/><ellipse cx="587.25" cy="785.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M589.25,782 Q589.4531,781.5 589.6875,781.25 Q589.9219,781 590.1875,781 Q590.6563,781 590.9531,781.2813 Q591.25,781.5625 591.25,782.2188 L591.25,783.7813 Q591.25,784.4375 590.9688,784.7188 Q590.6875,785 590.25,785 Q589.8594,785 589.6094,784.8281 Q589.3594,784.6563 589.25,784.2031 Q589.2031,783.8906 589.0313,783.7188 Q588.7188,783.3906 588.1563,783.2031 Q587.5938,783 587.0313,783 Q586.3281,783 585.7344,783.2813 Q585.1563,783.5625 584.7031,784.1875 Q584.25,784.8125 584.25,785.6719 L584.25,786.5938 Q584.25,787.625 585.0938,788.3125 Q585.9375,789 587.4375,789 Q588.3281,789 588.9531,788.7969 Q589.3125,788.6875 589.7188,788.3281 Q589.9844,788.125 590.125,788.0625 Q590.2656,788 590.4375,788 Q590.7656,788 591,788.2656 Q591.25,788.5156 591.25,788.875 Q591.25,789.2188 590.9063,789.625 Q590.4063,790.2188 589.6094,790.5469 Q588.5625,791 587.2813,791 Q585.7813,791 584.5781,790.4063 Q583.6094,789.9375 582.9219,788.9219 Q582.25,787.9063 582.25,786.7031 L582.25,785.6094 Q582.25,784.3594 582.8438,783.2656 Q583.4531,782.1719 584.5,781.5938 Q585.5625,781 586.75,781 Q587.4688,781 588.0938,781.25 Q588.7188,781.5 589.25,782 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="170" x="607.75" y="790.4102">CardAccessNumberRequester</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="540" x2="813" y1="801.5" y2="801.5"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="547" y="810.918"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="559" y="816.9189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="547" y="824.7539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="249" x="559" y="830.7549">queue : ArrayBlockingQueue&lt;CardAccessNumber&gt;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="540" x2="813" y1="837.1719" y2="837.1719"/><ellipse cx="550" cy="849.5898" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="24" x="559" y="852.5908">call()</text><ellipse cx="550" cy="863.4258" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="559" y="866.4268">handleCan()</text><!--class PaceInfo--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="227.8672" id="PaceInfo" style="stroke: #A80036; stroke-width: 1.5;" width="174" x="329.5" y="707"/><ellipse cx="388.25" cy="723" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M390.25,719.5 Q390.4531,719 390.6875,718.75 Q390.9219,718.5 391.1875,718.5 Q391.6563,718.5 391.9531,718.7813 Q392.25,719.0625 392.25,719.7188 L392.25,721.2813 Q392.25,721.9375 391.9688,722.2188 Q391.6875,722.5 391.25,722.5 Q390.8594,722.5 390.6094,722.3281 Q390.3594,722.1563 390.25,721.7031 Q390.2031,721.3906 390.0313,721.2188 Q389.7188,720.8906 389.1563,720.7031 Q388.5938,720.5 388.0313,720.5 Q387.3281,720.5 386.7344,720.7813 Q386.1563,721.0625 385.7031,721.6875 Q385.25,722.3125 385.25,723.1719 L385.25,724.0938 Q385.25,725.125 386.0938,725.8125 Q386.9375,726.5 388.4375,726.5 Q389.3281,726.5 389.9531,726.2969 Q390.3125,726.1875 390.7188,725.8281 Q390.9844,725.625 391.125,725.5625 Q391.2656,725.5 391.4375,725.5 Q391.7656,725.5 392,725.7656 Q392.25,726.0156 392.25,726.375 Q392.25,726.7188 391.9063,727.125 Q391.4063,727.7188 390.6094,728.0469 Q389.5625,728.5 388.2813,728.5 Q386.7813,728.5 385.5781,727.9063 Q384.6094,727.4375 383.9219,726.4219 Q383.25,725.4063 383.25,724.2031 L383.25,723.1094 Q383.25,721.8594 383.8438,720.7656 Q384.4531,719.6719 385.5,719.0938 Q386.5625,718.5 387.75,718.5 Q388.4688,718.5 389.0938,718.75 Q389.7188,719 390.25,719.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="408.75" y="727.9102">PaceInfo</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="330.5" x2="502.5" y1="739" y2="739"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="748.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="349.5" y="754.4189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="762.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="100" x="349.5" y="768.2549">PARAMETER256 : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="776.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="100" x="349.5" y="782.0908">PARAMETER384 : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="789.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="100" x="349.5" y="795.9268">PARAMETER512 : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="803.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="96" x="349.5" y="809.7627">cardAccess : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="817.5977"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="349.5" y="823.5986">paceInfoProtocolBytes : byte[]</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="831.4336"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="349.5" y="837.4346">protocol : ASN1ObjectIdentifier</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="845.2695"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="78" x="349.5" y="851.2705">parameterID : int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="330.5" x2="502.5" y1="857.6875" y2="857.6875"/><polygon fill="#4177AF" points="340.5,866.1055,336.5,872.1055,344.5,872.1055" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="50" x="349.5" y="873.1064">PaceInfo()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="337.5" y="880.9414"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="81" x="349.5" y="886.9424">extractProtocol()</text><polygon fill="#4177AF" points="340.5,893.7773,336.5,899.7773,344.5,899.7773" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="132" x="349.5" y="900.7783">getPaceInfoProtocolBytes()</text><polygon fill="#4177AF" points="340.5,907.6133,336.5,913.6133,344.5,913.6133" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="109" x="349.5" y="914.6143">getParameterIDString()</text><polygon fill="#4177AF" points="340.5,921.4492,336.5,927.4492,344.5,927.4492" style="stroke: #1963A0; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="349.5" y="928.4502">getProtocolID()</text><!--class TrustedChannelConstructor--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="131.0156" id="TrustedChannelConstructor" style="stroke: #A80036; stroke-width: 1.5;" width="185" x="602" y="422"/><ellipse cx="617" cy="438" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M619,434.5 Q619.2031,434 619.4375,433.75 Q619.6719,433.5 619.9375,433.5 Q620.4063,433.5 620.7031,433.7813 Q621,434.0625 621,434.7188 L621,436.2813 Q621,436.9375 620.7188,437.2188 Q620.4375,437.5 620,437.5 Q619.6094,437.5 619.3594,437.3281 Q619.1094,437.1563 619,436.7031 Q618.9531,436.3906 618.7813,436.2188 Q618.4688,435.8906 617.9063,435.7031 Q617.3438,435.5 616.7813,435.5 Q616.0781,435.5 615.4844,435.7813 Q614.9063,436.0625 614.4531,436.6875 Q614,437.3125 614,438.1719 L614,439.0938 Q614,440.125 614.8438,440.8125 Q615.6875,441.5 617.1875,441.5 Q618.0781,441.5 618.7031,441.2969 Q619.0625,441.1875 619.4688,440.8281 Q619.7344,440.625 619.875,440.5625 Q620.0156,440.5 620.1875,440.5 Q620.5156,440.5 620.75,440.7656 Q621,441.0156 621,441.375 Q621,441.7188 620.6563,442.125 Q620.1563,442.7188 619.3594,443.0469 Q618.3125,443.5 617.0313,443.5 Q615.5313,443.5 614.3281,442.9063 Q613.3594,442.4375 612.6719,441.4219 Q612,440.4063 612,439.2031 L612,438.1094 Q612,436.8594 612.5938,435.7656 Q613.2031,434.6719 614.25,434.0938 Q615.3125,433.5 616.5,433.5 Q617.2188,433.5 617.8438,433.75 Q618.4688,434 619,434.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="153" x="631" y="442.9102">TrustedChannelConstructor</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="603" x2="786" y1="454" y2="454"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="610" y="463.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="622" y="469.4189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="610" y="477.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="59" x="622" y="483.2549">TAG : String</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="610" y="491.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="107" x="622" y="497.0908">RECEIVE_BUFFER : int</text><ellipse cx="613" cy="507.9258" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="63" x="622" y="510.9268">TIMEOUT : int</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="603" x2="786" y1="517.3438" y2="517.3438"/><ellipse cx="613" cy="529.7617" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="141" x="622" y="532.7627">TrustedChannelConstructor()</text><ellipse cx="613" cy="543.5977" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="24" x="622" y="546.5986">run()</text><!--class TrustedChannelPaceKeyExchange--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="283.2109" id="TrustedChannelPaceKeyExchange" style="stroke: #A80036; stroke-width: 1.5;" width="237" x="330" y="346"/><ellipse cx="351.3" cy="362" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M353.3,358.5 Q353.5031,358 353.7375,357.75 Q353.9719,357.5 354.2375,357.5 Q354.7063,357.5 355.0031,357.7813 Q355.3,358.0625 355.3,358.7188 L355.3,360.2813 Q355.3,360.9375 355.0188,361.2188 Q354.7375,361.5 354.3,361.5 Q353.9094,361.5 353.6594,361.3281 Q353.4094,361.1563 353.3,360.7031 Q353.2531,360.3906 353.0813,360.2188 Q352.7688,359.8906 352.2063,359.7031 Q351.6438,359.5 351.0813,359.5 Q350.3781,359.5 349.7844,359.7813 Q349.2063,360.0625 348.7531,360.6875 Q348.3,361.3125 348.3,362.1719 L348.3,363.0938 Q348.3,364.125 349.1438,364.8125 Q349.9875,365.5 351.4875,365.5 Q352.3781,365.5 353.0031,365.2969 Q353.3625,365.1875 353.7688,364.8281 Q354.0344,364.625 354.175,364.5625 Q354.3156,364.5 354.4875,364.5 Q354.8156,364.5 355.05,364.7656 Q355.3,365.0156 355.3,365.375 Q355.3,365.7188 354.9563,366.125 Q354.4563,366.7188 353.6594,367.0469 Q352.6125,367.5 351.3313,367.5 Q349.8313,367.5 348.6281,366.9063 Q347.6594,366.4375 346.9719,365.4219 Q346.3,364.4063 346.3,363.2031 L346.3,362.1094 Q346.3,360.8594 346.8938,359.7656 Q347.5031,358.6719 348.55,358.0938 Q349.6125,357.5 350.8,357.5 Q351.5188,357.5 352.1438,357.75 Q352.7688,358 353.3,358.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="191" x="366.7" y="366.9102">TrustedChannelPaceKeyExchange</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="331" x2="566" y1="378" y2="378"/><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="387.418"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="65" x="350" y="393.4189">LOG : Logger</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="401.2539"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" text-decoration="underline" textLength="150" x="350" y="407.2549">SECRET_KEY_REFERENCE : int</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="415.0898"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="86" x="350" y="421.0908">card : IHealthCard</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="428.9258"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="55" x="350" y="434.9268">can : String</text><rect fill="none" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="442.7617"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="99" x="350" y="448.7627">paceInfo : PaceInfo[]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="331" x2="566" y1="455.1797" y2="455.1797"/><ellipse cx="341" cy="467.5977" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="175" x="350" y="470.5986">TrustedChannelPaceKeyExchange()</text><ellipse cx="341" cy="481.4336" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="95" x="350" y="484.4346">negotiatePaceKey()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="492.2695"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="350" y="498.2705">selectEfMf()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="506.1055"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="350" y="512.1064">selectEfCardAccess()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="519.9414"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="84" x="350" y="525.9424">extractPaceInfo()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="533.7773"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="145" x="350" y="539.7783">manageSecurityEnvironment()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="547.6133"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="126" x="350" y="553.6143">createEncryptedNonceZ()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="561.4492"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="196" x="350" y="567.4502">generateEphemeralPublicKeyFirstECDH()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="575.2852"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="59" x="350" y="581.2861">mapNonce()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="589.1211"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="118" x="350" y="595.1221">performKeyAgreement()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="602.957"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="350" y="608.958">mutualAuthentication()</text><rect fill="#F24D5C" height="6" style="stroke: #C82930; stroke-width: 1.0;" width="6" x="338" y="616.793"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="211" x="350" y="622.7939">compareCalculatedAndReceivedMacPiccs()</text><!--class Thread--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="61.8359" id="Thread" style="stroke: #A80036; stroke-width: 1.5;" width="71" x="895" y="122"/><ellipse cx="910" cy="138" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M912,134.5 Q912.2031,134 912.4375,133.75 Q912.6719,133.5 912.9375,133.5 Q913.4063,133.5 913.7031,133.7813 Q914,134.0625 914,134.7188 L914,136.2813 Q914,136.9375 913.7188,137.2188 Q913.4375,137.5 913,137.5 Q912.6094,137.5 912.3594,137.3281 Q912.1094,137.1563 912,136.7031 Q911.9531,136.3906 911.7813,136.2188 Q911.4688,135.8906 910.9063,135.7031 Q910.3438,135.5 909.7813,135.5 Q909.0781,135.5 908.4844,135.7813 Q907.9063,136.0625 907.4531,136.6875 Q907,137.3125 907,138.1719 L907,139.0938 Q907,140.125 907.8438,140.8125 Q908.6875,141.5 910.1875,141.5 Q911.0781,141.5 911.7031,141.2969 Q912.0625,141.1875 912.4688,140.8281 Q912.7344,140.625 912.875,140.5625 Q913.0156,140.5 913.1875,140.5 Q913.5156,140.5 913.75,140.7656 Q914,141.0156 914,141.375 Q914,141.7188 913.6563,142.125 Q913.1563,142.7188 912.3594,143.0469 Q911.3125,143.5 910.0313,143.5 Q908.5313,143.5 907.3281,142.9063 Q906.3594,142.4375 905.6719,141.4219 Q905,140.4063 905,139.2031 L905,138.1094 Q905,136.8594 905.5938,135.7656 Q906.2031,134.6719 907.25,134.0938 Q908.3125,133.5 909.5,133.5 Q910.2188,133.5 910.8438,133.75 Q911.4688,134 912,134.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="39" x="924" y="142.9102">Thread</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="896" x2="965" y1="154" y2="154"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="896" x2="965" y1="162" y2="162"/><ellipse cx="906" cy="174.418" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="24" x="915" y="177.4189">run()</text><!--class Callable--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="48" id="Callable" style="stroke: #A80036; stroke-width: 1.5;" width="78" x="1155.5" y="463.5"/><ellipse cx="1170.5" cy="479.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1172.5,476 Q1172.7031,475.5 1172.9375,475.25 Q1173.1719,475 1173.4375,475 Q1173.9063,475 1174.2031,475.2813 Q1174.5,475.5625 1174.5,476.2188 L1174.5,477.7813 Q1174.5,478.4375 1174.2188,478.7188 Q1173.9375,479 1173.5,479 Q1173.1094,479 1172.8594,478.8281 Q1172.6094,478.6563 1172.5,478.2031 Q1172.4531,477.8906 1172.2813,477.7188 Q1171.9688,477.3906 1171.4063,477.2031 Q1170.8438,477 1170.2813,477 Q1169.5781,477 1168.9844,477.2813 Q1168.4063,477.5625 1167.9531,478.1875 Q1167.5,478.8125 1167.5,479.6719 L1167.5,480.5938 Q1167.5,481.625 1168.3438,482.3125 Q1169.1875,483 1170.6875,483 Q1171.5781,483 1172.2031,482.7969 Q1172.5625,482.6875 1172.9688,482.3281 Q1173.2344,482.125 1173.375,482.0625 Q1173.5156,482 1173.6875,482 Q1174.0156,482 1174.25,482.2656 Q1174.5,482.5156 1174.5,482.875 Q1174.5,483.2188 1174.1563,483.625 Q1173.6563,484.2188 1172.8594,484.5469 Q1171.8125,485 1170.5313,485 Q1169.0313,485 1167.8281,484.4063 Q1166.8594,483.9375 1166.1719,482.9219 Q1165.5,481.9063 1165.5,480.7031 L1165.5,479.6094 Q1165.5,478.3594 1166.0938,477.2656 Q1166.7031,476.1719 1167.75,475.5938 Q1168.8125,475 1170,475 Q1170.7188,475 1171.3438,475.25 Q1171.9688,475.5 1172.5,476 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="1184.5" y="484.4102">Callable</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1156.5" x2="1232.5" y1="495.5" y2="495.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1156.5" x2="1232.5" y1="503.5" y2="503.5"/><!--class ICardAccessNumberResponseListener--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="48" id="ICardAccessNumberResponseListener" style="stroke: #A80036; stroke-width: 1.5;" width="250" x="870.5" y="463.5"/><ellipse cx="885.5" cy="479.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M887.5,476 Q887.7031,475.5 887.9375,475.25 Q888.1719,475 888.4375,475 Q888.9063,475 889.2031,475.2813 Q889.5,475.5625 889.5,476.2188 L889.5,477.7813 Q889.5,478.4375 889.2188,478.7188 Q888.9375,479 888.5,479 Q888.1094,479 887.8594,478.8281 Q887.6094,478.6563 887.5,478.2031 Q887.4531,477.8906 887.2813,477.7188 Q886.9688,477.3906 886.4063,477.2031 Q885.8438,477 885.2813,477 Q884.5781,477 883.9844,477.2813 Q883.4063,477.5625 882.9531,478.1875 Q882.5,478.8125 882.5,479.6719 L882.5,480.5938 Q882.5,481.625 883.3438,482.3125 Q884.1875,483 885.6875,483 Q886.5781,483 887.2031,482.7969 Q887.5625,482.6875 887.9688,482.3281 Q888.2344,482.125 888.375,482.0625 Q888.5156,482 888.6875,482 Q889.0156,482 889.25,482.2656 Q889.5,482.5156 889.5,482.875 Q889.5,483.2188 889.1563,483.625 Q888.6563,484.2188 887.8594,484.5469 Q886.8125,485 885.5313,485 Q884.0313,485 882.8281,484.4063 Q881.8594,483.9375 881.1719,482.9219 Q880.5,481.9063 880.5,480.7031 L880.5,479.6094 Q880.5,478.3594 881.0938,477.2656 Q881.7031,476.1719 882.75,475.5938 Q883.8125,475 885,475 Q885.7188,475 886.3438,475.25 Q886.9688,475.5 887.5,476 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="218" x="899.5" y="484.4102">ICardAccessNumberResponseListener</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="871.5" x2="1119.5" y1="495.5" y2="495.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="871.5" x2="1119.5" y1="503.5" y2="503.5"/><!--class RequestPaceKeyEvent--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="48" id="RequestPaceKeyEvent" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="116" y="797"/><ellipse cx="131" cy="813" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M133,809.5 Q133.2031,809 133.4375,808.75 Q133.6719,808.5 133.9375,808.5 Q134.4063,808.5 134.7031,808.7813 Q135,809.0625 135,809.7188 L135,811.2813 Q135,811.9375 134.7188,812.2188 Q134.4375,812.5 134,812.5 Q133.6094,812.5 133.3594,812.3281 Q133.1094,812.1563 133,811.7031 Q132.9531,811.3906 132.7813,811.2188 Q132.4688,810.8906 131.9063,810.7031 Q131.3438,810.5 130.7813,810.5 Q130.0781,810.5 129.4844,810.7813 Q128.9063,811.0625 128.4531,811.6875 Q128,812.3125 128,813.1719 L128,814.0938 Q128,815.125 128.8438,815.8125 Q129.6875,816.5 131.1875,816.5 Q132.0781,816.5 132.7031,816.2969 Q133.0625,816.1875 133.4688,815.8281 Q133.7344,815.625 133.875,815.5625 Q134.0156,815.5 134.1875,815.5 Q134.5156,815.5 134.75,815.7656 Q135,816.0156 135,816.375 Q135,816.7188 134.6563,817.125 Q134.1563,817.7188 133.3594,818.0469 Q132.3125,818.5 131.0313,818.5 Q129.5313,818.5 128.3281,817.9063 Q127.3594,817.4375 126.6719,816.4219 Q126,815.4063 126,814.2031 L126,813.1094 Q126,811.8594 126.5938,810.7656 Q127.2031,809.6719 128.25,809.0938 Q129.3125,808.5 130.5,808.5 Q131.2188,808.5 131.8438,808.75 Q132.4688,809 133,809.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="125" x="145" y="817.9102">RequestPaceKeyEvent</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="117" x2="272" y1="829" y2="829"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="117" x2="272" y1="837" y2="837"/><!--class MacPcd--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="48" id="MacPcd" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="6" y="797"/><ellipse cx="21" cy="813" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M23,809.5 Q23.2031,809 23.4375,808.75 Q23.6719,808.5 23.9375,808.5 Q24.4063,808.5 24.7031,808.7813 Q25,809.0625 25,809.7188 L25,811.2813 Q25,811.9375 24.7188,812.2188 Q24.4375,812.5 24,812.5 Q23.6094,812.5 23.3594,812.3281 Q23.1094,812.1563 23,811.7031 Q22.9531,811.3906 22.7813,811.2188 Q22.4688,810.8906 21.9063,810.7031 Q21.3438,810.5 20.7813,810.5 Q20.0781,810.5 19.4844,810.7813 Q18.9063,811.0625 18.4531,811.6875 Q18,812.3125 18,813.1719 L18,814.0938 Q18,815.125 18.8438,815.8125 Q19.6875,816.5 21.1875,816.5 Q22.0781,816.5 22.7031,816.2969 Q23.0625,816.1875 23.4688,815.8281 Q23.7344,815.625 23.875,815.5625 Q24.0156,815.5 24.1875,815.5 Q24.5156,815.5 24.75,815.7656 Q25,816.0156 25,816.375 Q25,816.7188 24.6563,817.125 Q24.1563,817.7188 23.3594,818.0469 Q22.3125,818.5 21.0313,818.5 Q19.5313,818.5 18.3281,817.9063 Q17.3594,817.4375 16.6719,816.4219 Q16,815.4063 16,814.2031 L16,813.1094 Q16,811.8594 16.5938,810.7656 Q17.2031,809.6719 18.25,809.0938 Q19.3125,808.5 20.5,808.5 Q21.2188,808.5 21.8438,808.75 Q22.4688,809 23,809.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="43" x="35" y="817.9102">MacPcd</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="80" y1="829" y2="829"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="80" y1="837" y2="837"/><!--class RequestCardAccessNumberEvent--><rect fill="#FEFECE" filter="url(#f1qjbjj5ydlljr)" height="48" id="RequestCardAccessNumberEvent" style="stroke: #A80036; stroke-width: 1.5;" width="221" x="566" y="1022"/><ellipse cx="581" cy="1038" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M583,1034.5 Q583.2031,1034 583.4375,1033.75 Q583.6719,1033.5 583.9375,1033.5 Q584.4063,1033.5 584.7031,1033.7813 Q585,1034.0625 585,1034.7188 L585,1036.2813 Q585,1036.9375 584.7188,1037.2188 Q584.4375,1037.5 584,1037.5 Q583.6094,1037.5 583.3594,1037.3281 Q583.1094,1037.1563 583,1036.7031 Q582.9531,1036.3906 582.7813,1036.2188 Q582.4688,1035.8906 581.9063,1035.7031 Q581.3438,1035.5 580.7813,1035.5 Q580.0781,1035.5 579.4844,1035.7813 Q578.9063,1036.0625 578.4531,1036.6875 Q578,1037.3125 578,1038.1719 L578,1039.0938 Q578,1040.125 578.8438,1040.8125 Q579.6875,1041.5 581.1875,1041.5 Q582.0781,1041.5 582.7031,1041.2969 Q583.0625,1041.1875 583.4688,1040.8281 Q583.7344,1040.625 583.875,1040.5625 Q584.0156,1040.5 584.1875,1040.5 Q584.5156,1040.5 584.75,1040.7656 Q585,1041.0156 585,1041.375 Q585,1041.7188 584.6563,1042.125 Q584.1563,1042.7188 583.3594,1043.0469 Q582.3125,1043.5 581.0313,1043.5 Q579.5313,1043.5 578.3281,1042.9063 Q577.3594,1042.4375 576.6719,1041.4219 Q576,1040.4063 576,1039.2031 L576,1038.1094 Q576,1036.8594 576.5938,1035.7656 Q577.2031,1034.6719 578.25,1034.0938 Q579.3125,1033.5 580.5,1033.5 Q581.2188,1033.5 581.8438,1033.75 Q582.4688,1034 583,1034.5 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="189" x="595" y="1042.9102">RequestCardAccessNumberEvent</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="567" x2="786" y1="1054" y2="1054"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="567" x2="786" y1="1062" y2="1062"/><!--link Callable to CardAccessNumberRequester--><path d="M1186.65,531.545 C1179.04,562.192 1164.68,602.484 1138.5,629 C1050.77,717.859 915.721,767.167 814.255,793.314 " fill="none" id="Callable-CardAccessNumberRequester" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1179.87,529.76,1190.98,511.713,1193.55,532.746,1179.87,529.76" style="stroke: #A80036; stroke-width: 1.0;"/><!--link Thread to TrustedChannelConstructor--><path d="M897.416,200.611 C856.447,258.334 786.439,356.967 740.32,421.945 " fill="none" id="Thread-TrustedChannelConstructor" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="891.856,196.351,909.14,184.094,903.273,204.455,891.856,196.351" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ICardAccessNumberResponseListener to CardAccessNumberRequester--><path d="M959.294,526.125 C901.803,585.868 789.565,702.504 725.122,769.472 " fill="none" id="ICardAccessNumberResponseListener-CardAccessNumberRequester" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="954.41,521.105,973.322,511.547,964.498,530.812,954.41,521.105" style="stroke: #A80036; stroke-width: 1.0;"/><!--link TrustedChannelPaceKeyRequestHandler to RequestPaceKeyEvent--><path d="M377.869,236.46 C353.645,255.392 330.825,277.328 313.5,302 C199.491,464.356 193.046,719.37 193.906,796.889 " fill="none" id="TrustedChannelPaceKeyRequestHandler-RequestPaceKeyEvent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="388.324,228.53,381.1262,228.9684,378.7626,235.7812,385.9603,235.3427,388.324,228.53" style="stroke: #A80036; stroke-width: 1.0;"/><!--link TrustedChannelConstructor to RequestPaceKeyEvent--><path d="M649.042,563.917 C631.49,587.676 609.556,612.1 584.5,629 C480.593,699.085 422.274,644.735 313.5,707 C272.455,730.495 234.604,771.033 213.063,796.633 " fill="none" id="TrustedChannelConstructor-RequestPaceKeyEvent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="656.794,553.077,650.0501,555.6303,649.8132,562.8375,656.5571,560.2842,656.794,553.077" style="stroke: #A80036; stroke-width: 1.0;"/><!--link TrustedChannelPaceKeyExchange to MacPcd--><path d="M318.099,547.37 C246.206,584.933 159.442,639.291 98.5,707 C74.7082,733.434 58.9162,772.017 50.5822,796.562 " fill="none" id="TrustedChannelPaceKeyExchange-MacPcd" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="329.961,541.253,322.795,540.448,319.2957,546.7531,326.4617,547.5582,329.961,541.253" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="148.5" y="673.4951">macPcd</text><!--link TrustedChannelPaceKeyRequestHandler to TrustedChannelConstructor--><path d="M571.629,246.178 C599.282,300.265 633.658,367.499 659.011,417.087 " fill="none" id="TrustedChannelPaceKeyRequestHandler-TrustedChannelConstructor" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="661.436,421.83,660.9021,411.9956,659.1606,417.3777,653.7785,415.6363,661.436,421.83" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="595.5" y="290.4951">start Thread</text><!--link TrustedChannelConstructor to CardAccessNumberRequester--><path d="M690.987,553.203 C687.655,614.567 682.7,705.811 679.536,764.095 " fill="none" id="TrustedChannelConstructor-CardAccessNumberRequester" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="679.254,769.281,683.7367,760.5114,679.5254,764.2884,675.7484,760.0771,679.254,769.281" style="stroke: #A80036; stroke-width: 1.0;"/><!--link CardAccessNumberRequester to RequestCardAccessNumberEvent--><path d="M676.5,885.671 C676.5,931.228 676.5,989.9295 676.5,1021.838 " fill="none" id="CardAccessNumberRequester-RequestCardAccessNumberEvent" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="676.5,872.602,672.5,878.602,676.5,884.602,680.5,878.602,676.5,872.602" style="stroke: #A80036; stroke-width: 1.0;"/><!--link TrustedChannelPaceKeyExchange to PaceInfo--><path d="M433.662,642.216 C431.561,663.973 429.434,686.008 427.426,706.811 " fill="none" id="TrustedChannelPaceKeyExchange-PaceInfo" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#FFFFFF" points="434.929,629.086,430.3706,634.6736,433.7752,641.0304,438.3336,635.4428,434.929,629.086" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml

 package de.gematik.ti.healthcard.control {
      class TrustedChannelPaceKeyRequestHandler {
          {static} - LOG : Logger
          {static} - TAG : String
          {static} - instance : TrustedChannelPaceKeyRequestHandler
          - TrustedChannelPaceKeyRequestHandler()
          {static} + getInstance()
          {static} + startHandling()
          {static} + stopHandling()
          - register()
          - unregister()
          + handleRequestPaceKeyEvent()
      }
    }

    package de.gematik.ti.healthcard.control {
        package de.gematik.ti.healthcard.control.security {
          class CardAccessNumberRequester {
              {static} - LOG : Logger
              - queue : ArrayBlockingQueue<CardAccessNumber>
              + call()
              + handleCan()
          }
        }
      }


      package de.gematik.ti.healthcard.control {
        package de.gematik.ti.healthcard.control.security {
          class PaceInfo {
              {static} - LOG : Logger
              {static} - PARAMETER256 : int
              {static} - PARAMETER384 : int
              {static} - PARAMETER512 : int
              - cardAccess : byte[]
              - paceInfoProtocolBytes : byte[]
              - protocol : ASN1ObjectIdentifier
              - parameterID : int
              ~ PaceInfo()
              - extractProtocol()
              ~ getPaceInfoProtocolBytes()
              ~ getParameterIDString()
              ~ getProtocolID()
          }
        }
      }


      package de.gematik.ti.healthcard.control {
        package de.gematik.ti.healthcard.control.security {
          class TrustedChannelConstructor {
              {static} - LOG : Logger
              {static} - TAG : String
              {static} - RECEIVE_BUFFER : int
              {static} + TIMEOUT : int
              + TrustedChannelConstructor()
              + run()
          }
        }
      }

      package java.lang {
            class Thread {
                + run()
            }
      }


      package de.gematik.ti.healthcard.control {
        package de.gematik.ti.healthcard.control.security {
          class TrustedChannelPaceKeyExchange {
              {static} - LOG : Logger
              {static} - SECRET_KEY_REFERENCE : int
              - card : IHealthCard
              - can : String
              - paceInfo : PaceInfo[]
              + TrustedChannelPaceKeyExchange()
              + negotiatePaceKey()
              - selectEfMf()
              - selectEfCardAccess()
              - extractPaceInfo()
              - manageSecurityEnvironment()
              - createEncryptedNonceZ()
              - generateEphemeralPublicKeyFirstECDH()
              - mapNonce()
              - performKeyAgreement()
              - mutualAuthentication()
              - compareCalculatedAndReceivedMacPiccs()
          }
        }
      }


      CardAccessNumberRequester -up-|> Callable
      TrustedChannelConstructor -up-|> Thread
      CardAccessNumberRequester -up-|> ICardAccessNumberResponseListener
      TrustedChannelPaceKeyRequestHandler o- - RequestPaceKeyEvent
      TrustedChannelConstructor o- - RequestPaceKeyEvent
      TrustedChannelPaceKeyExchange o- - MacPcd : macPcd
      TrustedChannelPaceKeyRequestHandler ..> TrustedChannelConstructor : start Thread
      TrustedChannelConstructor ..> CardAccessNumberRequester
      CardAccessNumberRequester o- - RequestCardAccessNumberEvent
      TrustedChannelPaceKeyExchange o- - PaceInfo

@enduml

PlantUML version 1.2019.06(Fri May 24 19:10:25 CEST 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.4+10-b304.69
Operating System: Windows 7
OS Version: 6.1
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>